#{extends 'newAutoTitle/newAutoTitleBase.html' /}
#{set title:'标题还原中心' /}

<style type="text/css">
 .single-title-div{
    padding: 10px;
 }
 
 .searchDiv{
    width:100%;
    height:35px;
    display: block;
    margin:40px 0 40px 0;
 }
 
 .searchText{
    padding-left:10px;
    font-family:'微软雅黑';
    float:left;
    width:280px;
    height: 33px;
 }
 
 .timeText{
    padding-left:10px;
    font-family:'微软雅黑';
    float:left;
    width:280px;
    height: 40px;
    margin-right:5px;   
 }
 .searchDivIn{
    width: 370px;
    height: 35px;
    display: inline;
    float:left;
    width:100%;
 }

 .all-title-div{
    padding: 10px;
 }
 
 .time-title-div{
    padding: 10px;
 }
 
 .item-table tbody td {
    padding: 7px 0px;
 }

.timetip{
    float:left;
    font-size:17px;
    text-align:center;
    height:40px;
    line-height:40px;
    margin-right:5px;
 }
 .search-container{
    border: 1px solid #ccc;
    margin: 0px 0px 20px 0px;
    padding: 20px 0px 20px 20px;
    background: #efefef;
  }
  
  input[type="text"] {
    padding-left: 5px;
  }
  
  .select35{
    height: 35px;
  }
</style>
<link rel="stylesheet" type="text/css" href="/public/javascripts/newAutoTitle/DateTimePicker/jquery.datetimepicker.css"/>



<div style="height:10px;"></div>
<div class="header-tip-container">单个宝贝标题还原，批量宝贝标题还原和所有宝贝标题还原到固定时间点</div>
<div class="base-tab-out">

   
    
    <div class="base-tab-div">
        <span class="base-tab-unit title-reduce-tab single-title-tab select-tab" targetDiv="single-title-div">单标题还原</span>
        <span class="base-tab-unit title-reduce-tab all-title-tab" targetDiv="all-title-div" >全店标题还原</span>
        <span class="base-tab-unit title-reduce-tab time-title-tab" targetDiv="time-title-div">按时间点标题还原</span>
    </div>
    
    <div class="single-title-div title-tab-target-div" style="display:block;">
        
       <!-- <div class="searchDiv">
            <div class="searchDivIn">
                <input class="searchText" id="searchText" style="border-radius:0px;border:1px solid #0095b1" type="text" value="输入关键词搜索商品">
                <span class="startBtn titleBtn titleSingleBtn"></span>
            </div>
        </div>-->

		<!--<div id="itemsInfoSearch" class="data_search" style="margin-bottom:20px;">
			<ul>
				<li class="left" style="margin-left: 30px;">
				    <select id="taobaoCat" class="input_border_radius">
				    </select>
				</li>
				<li class="left">
				    <select id="itemStatus" class="input_border_radius s_w_4">
						<option value="all">所有宝贝</option>
						<option value="onsale" selected="selected">出售中的宝贝</option>
						<option value="instock">仓库中的宝贝</option>
				    </select>
			    </li>
				<li class="left">
				    <select class="input_border_radius s_w_4" id="itemsSortBy">
						<option tag="sortBy">默认排序</option>
						<option tag="sortByScoreUp">得分升序</option>
						<option tag="sortByScoreDown">得分降序</option>
				    </select>
				</li>
				<li class="left">得分:<input id="lowScore" value="0"> - <input id="highScore" value="100">
				</li>
				<li class="right" style="margin-right: 30px;">
					<button type="button" class="search_btn titleSingleBtn" name="goSearchItems" id="goSearchItems">
					</button>
				</li>
				<li class="right" style="margin-right: 0"><input id="searchText" type="text" value="" style="width:150px;" class="input_border_radius" name="searchWord" id="searchWord" value="" maxlength="30">
				</li>
			</ul>
		</div>-->
	   <div class="search-container">
            <table style="border-collapse: collapse; ">
                <tbody>
                <tr>
                    <td style="">
                        <span>宝贝标题：</span>
                        <input type="text" class="search-text select35" id="searchText" style="width: 150px;"/>
                    </td>
                    <td style="padding-left: 10px;">
                        <select class="tb-category-select select35" id="taobaoCat" style="width: 130px;">
                            <option value="0" selected="selected">所有淘宝类目</option>
                        </select>
                    </td>
                    <td style="padding-left: 10px;">
                        <select class="seller-category-select select35" id="itemsCat" style="width: 130px;">
                            <option value="0" selected="selected">所有店铺分类</option>
                        </select>
                    </td>
                    <td style="padding-left: 10px;">
                        <select class="state-select select35" id="itemStatus" style="width: 130px;">
                            <option value="2" selected="selected">所有宝贝状态</option>
                            <option value="0">在架宝贝</option>
                            <option value="1">仓库中的宝贝</option>
                        </select>
                    </td>
                    <td style="padding-left: 10px;">
                        得分:
                        <input type="text" class="start-score-text score-text" id="lowScore" style="width: 40px;" value="0">
                        -
                        <input type="text" class="end-score-text score-text" id="highScore" style="width: 40px;"  value="100">
                    </td>
                    <td style="padding-left: 20px;">
                        <span class="tmbtn sky-blue-btn search-btn titleSingleBtn">搜索宝贝</span>
                    </td>
                </tr>
                </tbody>
             </table>
        </div>
		

		<div class="single-paging-div" style="font-size:14px; text-align: center;"></div>
        
        <table class="item-table title-single-table list-table">
        <thead>
        <tr>
            <td style="width:11%;">图片</td>
            <td style="width:30%">当前标题</td>
            <td style="width:12%"><div class="sort-td sort-up" value="1" orderBy="salesCount">标题得分</div></td>
            <td style="width:14%">本月销量</td>
            <td style="width:17%">查看详情</td>
        </tr>
        </thead>
        <tbody></tbody>
        </table>
        
        <div class="single-paging-div" style="font-size:14px; text-align: center"></div>
    </div>
    
    <div class="all-title-div title-tab-target-div" style="display:none; margin-top:10px;">
        <div class="all-paging-div" style="font-size:14px; text-align:center;"></div>
        
        <table class="item-table title-all-table list-table">
        <thead>
        <tr>
            <td style="width:10%;">序号</td>
            <td style="width:20%;">操作时间</td>
            <td style="width:20%;">成功优化宝贝数</td>
            <td style="width:25%;">查看详情</td>
            <td style="width:25%;">一键还原</td>
        </tr>
        </thead>
        <tbody></tbody>
        </table>
        
        <div class="all-paging-div" style="font-size:14px; text-align:center;"></div>
    </div>
    
    <div class="time-title-div title-tab-target-div" style="display:none;min-height:600px;">
        <div class="searchDiv">
            <div class="searchDivIn">
                <span class="timetip">请选择还原的时间点</span>
                <input class="timeText" id="calender" type="text" value="请点击选择时间输入"/>
                <span class="tmbtn wide-sky-blue-btn timeTitleBtn" style="margin-left:10px;">查看历史标题</span>
                <span class="tmbtn wide-yellow-btn onekeyreducebtn" style="text-align:center; margin-left:10px;">一键还原到时间点</span>
            </div>
        </div>
        
        <div class="timetitleholder" style="display:none;">
        <div>
            <div class="time-paging-div" style="font-size:14px; text-align:center;"></div>
                <table class="list-table item-table">
                    <thead>
                    <tr>
                        <td style="width: 13%; font-size: 14px">序号</td>
                        <td style="width: 30%; font-size: 14px">旧标题</td>
                        <td style="width: 30%; font-size: 14px">新标题</td>
                        <td style="width: 27%; font-size: 14px">操作时间</td>
                    </tr>
                    </thead>

                    <tbody>
                    
                    </tbody>
                </table>
            <div class="time-paging-div" style="font-size:14px; text-align:center;"></div>
        </div>
        </div>
    
    </div>
</div>

<script src="/js/jquery.tmpl.js" type="text/javascript"></script>

<script type="text/x-jquery-tmpl" id="titlesingletmpl">
    <tr>
         <td><span><img style="width:80px; height:80px; " src="{{= picURL}}" alt="图片加载失败" /></span></td>
         <td>{{= title}}</td>
         <td>{{= score}}</td>
         <td>{{= tradeItemNum}}</td>
         <td><span class="tmbtn short-green-btn historyTitle" targetId='{{= id}}'> 历史标题</span></td>
    </tr>
</script>

<script type="text/x-jquery-tmpl" id="historytitlestmpl">
<div class="historyDiv">
    <table class="list-table" style="width: 100%;">
        <thead>
        <tr style="text-align:center;">
            <td style="width: 30%;">原标题</td>
            <td style="width: 30%;">新标题</td>
            <td style="width: 15%;">修改时间</td>
            <td style="width: 15%; border-right:0;">操作</td>
        </tr>
        </thead>


       <tbody class="reduceSingleTitleBody">
            {{each(i,val) res}}
            <tr style=" width:100%;  height:50px;text-align:center;">
                  <td style="padding-left:20px; padding-right:20px;">{{= val.oldTitle}}</td>
                  <td style="padding-left:15px; padding-right:20px;">{{= val.newTitle}}</td>
                  <td style="padding-left:20px; padding-right:20px;">{{= val.updated}} </td>
                  <td style="padding-left:14px; padding-right:20px;">
                    <span class="tmbtn short-green-btn reduceSingleTitle" oldTitle="{{=  val.oldTitle}}" targetId='{{= val.numIid}}'> 还原</span>
                  </td>
          </tr>
         {{/each}}
         </tbody>
    </table>
</div>
</script>

<script type="text/x-jquery-tmpl" id="titlealltmpl">
<tr>
    <td>{{= id}}</td>
    <td>{{= ts}}</td>
    <td>{{= successNum}}</td>
    <td><span class="detailBtn tmbtn short-green-btn" targetId='{{= id}}' succn='{{= successNum}}' > 查看详情</span> </td>
    <td><span class="oneKeyReduce tmbtn short-green-btn" targetId='{{= id}}' succn='{{= successNum}}'> 一键还原</span></td>
</tr>
</script>

<script type="text/x-jquery-tmpl" id="batchAllDetail">
<div>
    <table class="list-table" style="width: 100%;">
        <thead>
        <tr style="text-align:center;">
            <td style="width: 15%">宝贝图片</td>
            <td style="width: 30%">原标题</td>
            <td style="witdh: 30%">执行结果</td>
            <td style="width: 10%">是否成功</td>
            <td style="width: 15%">操作说明</td>
        </tr>    
        </thead>

        <tbody >
        {{each(i,val) dataArr}}
        <tr style="text-align:center;">
            <td>
                <div>
                    <a href="http://item.taobao.com/item.htm?id={{= numIid}}" target="_blank">
                        <img id="maskTableImg" style="width:80px; height:80px; " src="{{= val.picPath}}" title="商品图片" alt="加载失败"/>
                    </a>
                </div>
            </td>
            <td>{{= val.originTitle}}</td>
            <td>{{= val.newTitle}}</td>
            <td>
               {{if val.ok}}
               成功
               {{else}}
               失败
               {{/if}}
            </td>
            <td>
                {{if val.msg==null||val.msg==""}}
                正常
                {{else}}
                {{= val.msg}}
                {{/if}}
            </td>
        </tr>
        {{/each}}
        </tbody>
    </table>
</div>
</script>

<script type="text/x-jquery-tmpl" id="titletimetmpl">
<tr>
     <td>{{= num}}</td>
     <td>{{= title}}</td>
     <td>{{= toBackTitle}}</td>
     <td>{{= lastOptimiseTs}}</td>
</tr>
</script>
<script type="text/javascript">
     
     TM.Loading.init.show();
     
     TM.gcs('/js/tm.js', function(){
    		  TM.gcs('/public/javascripts/newAutoTitle/DateTimePicker/jquery.datetimepicker.js', function () {
    			    TM.gcs('/js/newAutoTitle/titlereduce.js?_v=1', function(){
    			    	  $(document).ready(function(){
    			    		   TM.TitleReduceAdmin.init.doInit($('.base-tab-out')); 
    			          }); 
    			    });
    		  });
     });

</script>