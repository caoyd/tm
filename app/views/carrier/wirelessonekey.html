#{extends 'carrier/carrierbase.html' /}
#{set title:'一键生成手机详情页' /}

<link rel="stylesheet" media="screen" href="/css/cornerDiv.css"/>

<style type="text/css">
    .user-admin-wrapper {
        font-family: "微软雅黑"; font-size: 14px; background: white;
    }
    .user-info-tip {
        font-size: 20px; font-weight: bold;
    }
    .width950 {
        width: 950px; margin: 0 auto;
    }
    .user-info-table {
        border: 1px solid #999;border-collapse: collapse;
    }
    .user-info-table td {
        border: 1px solid #999;
    }
    .user-info-table .attr-name-td {
        background: #eee; text-align: right; padding: 10px 20px 10px 0px;
    }
    .user-info-table .attr-value-td {
        text-align: left; padding: 10px 0px 10px 20px;
    }
    .paging-div{text-align: center;}
    .thumbnail{display: inline-block;}
    .info-area{display:none;}
    input.checkAll{width:24px;height:24px;display:inline-block;*display:inline;}
    .skincomment-table thead tr{background:#fcfcfc;}

</style>

*{http://img01.taobaocdn.com/tps/i1/T1FnYaXfFhXXc9v57_-10-10.png  }*
*{http:///img01.taobaocdn.com/tps/i1/T1FnYaXfFhXXc9v57_-10-10.png }*


*{<div>}*
    *{<table class="page-table busSearch">}*
        *{<thead>}*
        *{<tr>}*
            *{<th colspan="2">全店一键生成手机详情页</th>}*
        *{</tr>}*
        *{</thead>}*
        *{<tbody>}*
        *{<tr>}*
            *{<td>}*

            *{</td>}*
        *{</tr>}*
        *{</tbody>}*
    *{</table>}*
*{</div>}*
<div>
    <div style="width:600px;height:30px;text-align: center;margin: 0px auto;;">
        <a target="_blank" href="http://bangpai.taobao.com/group/thread/16102014-289725559.htm?spm=0.0.0.0.N2b3T3&qq-pf-to=pcqq.group" style="font-size:28px">
            操作教程
        </a>
    </div>
    <div style="width:600px;height:100px;text-align: center;margin: 12px auto;">
                <span id="openUpCsvDiagBtn" class="btn" style="">
                    全店一键生成手机详情页
                </span>
    </div>
</div>

<div class="user-admin-wrapper " style="padding: 20px 0px 50px; ">
    <table class="page-table busSearch">
        <thead>
        <tr>
            <th colspan="2">选中生成手机详情页</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td rowspan="5" style="width:20%;text-align: right;color:#FF0000;">操作指南：</td>
            <td style="height:32px;"> 1、选中您要生成手机详情页的宝贝,点击“生成手机详情页”</td>
        </tr>
        <tr>
            *{<td></td>}*
            <td style="height:32px;">2、到任务中心查看，等待任务完成，下载到本地</td>
        </tr>
        <tr>
            *{<td></td>}*
            <td style="height:32px;">3、下载安装[<a href="http://zhuli.taobao.com/" target="_blank" >淘宝助理</a>]，打开软件，勾选您要倒入手机详情页的宝贝，然后选择'导入CSV'</td>
        </tr>
        <tr>
        *{<td></td>}*
            <td style="height:32px;">4、导入完成后，点击上传宝贝，将无线详情页同步到淘宝</td>
        </tr>
        <tr>
            *{<td></td>}*
            <td style="color:#0000ff;height:32px;">如果您还是不清楚怎么操作，&gt;&gt;
                <a href="http://bangpai.taobao.com/group/thread/16102014-289725559.htm?spm=0.0.0.0.N2b3T3&qq-pf-to=pcqq.group" target="_blank">点击这里看图文详细教程</a>！</td>
        </tr>

        </tbody>
    </table>

    <div class="log-table-div">

        <table class="skincomment-table busSearch">

            <thead>
            <tr>
                <td colspan="10" style="text-align: center;">
                    <span class="searchTitle">标题关键词：</span>
                    <input type="text" id="searchText" value="" class="textinput" style="width:160px;">
                    <input type="text" id="lowBegin" value="0" style="display:none;">
                    <input type="text" id="topEnd" value="100" style="display:none;">
                    <span>&nbsp;</span>
                    <div style="display:inline-block;*display:inline;position: relative;">
                        <select name="itemsCat" id="itemsCat" style="display:inline-block;*display:inline;position: relative;overflow:hidden;">
                            <option>卖家分类</option>
                        </select>
                        <select name="taobaoCat" id="taobaoCat" style="display:inline-block;*display:inline;position: relative;overflow:hidden;">
                            <option>淘宝分类</option>
                        </select>
                    </div>
                    <div style="display:inline-block;*display:inline;position: relative;">
                        <select name="itemsStatus" id="itemsStatus" class="searchselect">
                            <option tag="all">全部宝贝</option>
                            <option tag="onsale">出售中的宝贝</option>
                            <option tag="instock">仓库中的宝贝</option>

                        </select>
                    </div>
                *{<div style="display:inline-block;*display:inline;position: relative;width:80px;">}*
                *{<select name="onlyItemLimit" id="onlyItemLimit" class="searchselect" style="width:80px;">}*
                *{<option tag="0">全部宝贝</option>}*
                *{<option tag="1">已限购宝贝</option>}*
                *{</select>}*
                *{</div>}*
                    <span class="search-btn btn btn-primary ">搜索宝贝</span>
                </td>
            </tr>
            <tr style="border-bottom: 1px solid #efefef;">
               <th colspan="2">
                   <a href="javascript:void(0)" class="batch-gen-mobile-page btn btn-info">生成手机详情页</a>
               </th>
               <th colspan="3">
                   <div class="paging-div" style="margin-top: 10px;"></div>
               </th>
            </tr>
            <tr>
                <th style="width:60px;text-align: center;vertical-align: middle;">
                    <input type="checkbox" tag="headCheck" class="checkAll" />
                </th>
                <th width="100px;">宝贝图片</th>
                <th width="">宝贝标题</th>
                <th width="30%">下架时间</th>
                <th width="20%">操作选项</th>
            </tr>
            </thead>
            <tbody id="rows">

            </tbody>
        </table>

        <div class="paging-div"></div>
    </div>

</div>


<div>
    *{<p style="text-align: center;">}*
   *{<span style="font-size:32px;color:#a10000;">使用教程</span>}*
   *{<span style="font-size:24px;">(没有淘宝助理的朋友请先下载淘宝助理5.5以上版本)</span>}*
    *{</p>}*

    *{<div class="blank0" style="height:5px;"></div>}*
   *{<p style="text-align: center;">}*

   *{<img src="http://img01.taobaocdn.com/imgextra/i1/1039626382/T27uKZXMJaXXXXXXXX-1039626382.jpg" />}*
       *{<img src="http://img03.taobaocdn.com/imgextra/i3/1039626382/T2pqCZXKhaXXXXXXXX-1039626382.jpg" />}*
   *{<img src="http://img03.taobaocdn.com/imgextra/i3/1039626382/T2TCi5XzRaXXXXXXXX-1039626382.jpg" />}*
   *{<img src="http://img01.taobaocdn.com/imgextra/i1/1039626382/T2.KCvXmpcXXXXXXXX-1039626382.jpg" />}*
   *{<img src="http://img02.taobaocdn.com/imgextra/i2/1039626382/T2rLWZXJtaXXXXXXXX-1039626382.jpg" />}*
    </p>
</div>
<div class="blank0" style="height:20px;">
</div>



<div class="uploadCsvDiag hidden">
    <form class="uploadCsvForm" action="/Wireless/batchSubmit" method="post">
        <table  class="uploadCsvOptTable" style="width:100%;">
            <tbody>

            <tr>
                <td style="width:250px;">
                    宝贝状态:
                </td>
                <td>
                    <input  name="config.notStatus" value="-1" type="radio" checked="checked"><span class="clickprev">全部状态&nbsp;</span>
                    <input  name="config.notStatus" value="0" type="radio"><span class="clickprev">出售中</span>
                    <input  name="config.notStatus" value="1" type="radio"><span class="clickprev">仓库中</span>
                </td>
            </tr>
            <tr>
                <td>
                    淘宝类目:
                </td>
                <td>
                    <select class="itemCatSelect" name="config.itemCat" >
                        <option value="-1">所有类目</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>
                    店铺类目:
                </td>
                <td>
                    <select class="sellerCatSelect" name="config.sellerCid" >
                        <option value="-1">所有类目</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td >自动切割超长图片</td>
                <td>
                    <input  name="config.autoSplit" value="true" type="radio" checked="checked"><span class="clickprev">是&nbsp;&nbsp;</span>
                    <input  name="config.autoSplit" value="false" type="radio"><span class="clickprev">否</span>
                </td>
            </tr>
            <tr>
                <td>自动生成文字介绍</td>
                <td>
                    <input  name="config.autoProp" value="true" type="radio" checked="checked"><span class="clickprev">是&nbsp;&nbsp;</span>
                    <input  name="config.autoProp" value="false" type="radio"><span class="clickprev">否</span>
                </td>
            </tr>
            <tr>
                <td>跳过已有手机详情页宝贝</td>
                <td>
                    <input  name="config.skipExist" value="true" type="radio" checked="checked"><span class="clickprev">是&nbsp;&nbsp;</span>
                    <input  name="config.skipExist" value="false" type="radio"><span class="clickprev">否</span>
                </td>
            </tr>
            <tr>
            </tr>
            </tbody>
        </table>
    </form>
</div>
<div class="">

</div>


<script type="text/x-jquery-tmpl" id="tplItem">
    <tr numiid="{{= id}}">
        <td style="width:60px;">
            <input numiid="{{= id}}" type="checkbox" tag="checkAll" class="checkAll" style=";;">
        </td>
        <td><a href="http://item.taobao.com/item.htm?id={{= id}}" target="_blank" class="thumbnail"><img class="imgsnap" src="{{= picURL}}_80x80.jpg" /></a></td>
        <td><a href="http://upload.taobao.com/auction/publish/edit.htm?item_num_id={{= id}}&auto=false" target="_blank">{{= title}}</a></td><td>{{= delistWeekDay}} {{= delistHHmmss}}</td>
        <td><a href="javascript:void(0)" class="gen-mobile-page btn btn-info">生成手机详情页</a></td>
    </tr>
    <tr><td colspan="4" class="info-area"></td></tr>
</script>


#{set 'moreScripts'}
<script type="text/javascript">
    var doInit = function(){
        $('#openUpCsvDiagBtn').click(function(){
            doDialog();
        })
        $('.clickprev').click(function(){
            $(this).prev().trigger('click');
        })
        $.get('/items/itemCatCount',function(data){
            if(!data || data.length == 0){
                return;
            }
            var taobaoCat = $('.itemCatSelect');
            taobaoCat.empty();

            var exist = false;
            var cat = $('<option value="-1">所有淘宝类目</option>');
            taobaoCat.append(cat);
            for(var i=0;i<data.length;i++) {
                if(data[i].count <= 0){
                    continue;
                }
                var option = $('<option></option>');
                option.attr("value",data[i].id);
                option.html(data[i].name+"("+data[i].count+")");
                taobaoCat.append(option);
            }
        })
        $.get('/items/sellerCatCount',function(data){
            var sellerCat = $('.sellerCatSelect');
            if(!data || data.length == 0){
                return;
            }
            sellerCat.empty();

            var exist = false;
            var cat = $('<option value="-1">所有店铺类目</option>');
            sellerCat.append(cat);
            for(var i=0;i<data.length;i++) {
                if(data[i].count <= 0){
                    continue;
                }

                var option = $('<option></option>');
                option.attr("value",data[i].id);
                option.html(data[i].name+"("+data[i].count+")");
                sellerCat.append(option);
            }
        })
    }
    var doDialog = function(){
        var doSubmit = function(diag){
            diag.find(".uploadCsvForm").ajaxSubmit(function(msg) {
                if(!msg){
                    alert('亲,系统异常,请稍后重试或联系客服');
                    diag.dialog('close');
                }
                if(msg.success){
    //                            alert('亲,上传成功,请稍后到任务中心查看结果');
                    window.location.reload();
                    alert('亲,任务创建成功,请稍后至任务中心进行下载');
                    diag.dialog('close');
                    return false;
                }else{
                    alert(msg.message);
                }
            });
        }
        $('.uploadCsvDiag').dialog({
            modal: true,
            bgiframe: true,
            height: 400,
            width:  600,
//            title : title || '提示',
            autoOpen: false,
            resizable: false,
            zIndex: 399,
            buttons:{
                '确定':function(){
                    var diag = $(this);
                    doSubmit(diag);
                },
                '取消':function(){
                    $(this).dialog('close');
                }
            },
            beforeClose:function(event, ui){
                $("body").unmask();
                $(this).unbind('keydown');
            },afterOpen:function(event, ui){
                var diag = $(this);
                diag.keydown(function(event) {
                    if (event.keyCode == "13") {//keyCode=13是回车键
                        doSubmit(diag);
                    }
                });
            }
        });
        $("body").mask();
        $('.uploadCsvDiag').dialog('open');


    }

    TM.gcs('/js/jquery.url.js',function(){
        TM.gcs('/js/jquery-ui-1.9.1.custom.min.js',function(){
            TM.gcs('/js/jquery.tmpl.js',function(){
                TM.gcs('/js/jquery.loadmask.min.js',function(){
                    TM.gcs('/js/utils/jquery.form.js',function(){
                        TM.gcs('/js/tm.js',function(){
                            $(document).ready(function(){
                                doInit();
                                TM.gcs('/js/carrier/mobiledesc.js?_v=5',function(){
                                    TM.MobileDesc.init.doInit($(".user-admin-wrapper"));
                                });
                            });
                        });
                    });
                });
            });
        });
    })
</script>
#{/set}